<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Minr Collaborations Map</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <div class="back-button">
        <a href="../" title="Back to homepage">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M19 12H5M12 19l-7-7 7-7" />
          </svg>
        </a>
      </div>
      <header>
        <h1>Minr Collaborations Map</h1>
        <h2>A visualisation of the Minr community network, by AK1089</h2>
      </header>

      <div class="search-container">
        <input
          type="text"
          id="search-input"
          placeholder="Search for a creator..."
        />
        <div id="search-results" class="search-results"></div>
      </div>

      <div class="graph-container">
        <svg id="network-graph"></svg>
      </div>

      <div id="node-info" class="node-info">
        <h3 id="info-title">Select a node to see details</h3>
        <div id="info-connections" class="info-section">
          <h4>Connections: <span id="connection-count">0</span></h4>
          <ul id="connection-list"></ul>
        </div>
        <div id="info-component" class="info-section">
          <h4>Component Size: <span id="component-size">0</span></h4>
        </div>
      </div>

      <footer>
        <p>
          Data from the
          <a
            href="https://docs.google.com/spreadsheets/d/12adnu29aV7pS7K62oacxKRFdaRifxzzw8-x1A-514MI/"
            target="_blank"
            >Map List</a
          >
          • <span id="node-count">0</span> creators • Last updated
          <span id="last-updated">loading...</span>
        </p>
      </footer>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="script.js"></script>

    <script>
      // Load visited URLs from localStorage
      let visitedUrls = new Set();
      const storedVisited = localStorage.getItem("visitedPages");
      if (storedVisited) {
        visitedUrls = new Set(JSON.parse(storedVisited));
      }

      // Log current page visit
      const currentPath = window.location.pathname.replace(/\/$/, "");
      visitedUrls.add(currentPath);
      localStorage.setItem(
        "visitedPages",
        JSON.stringify(Array.from(visitedUrls)),
      );
    </script>
  </body>
</html>
